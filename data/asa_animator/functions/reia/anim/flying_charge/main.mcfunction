# This function was generated by ArmorstandAnimator
scoreboard players add @s AsaMatrix 1
execute if score @s AsaMatrix matches 1 run function asa_animator:reia/anim/flying_charge/start
execute if score @s AsaMatrix matches 1 run function asa_animator:reia/anim/flying_charge/keyframes/0
execute if score @s AsaMatrix matches 1..5 run tp @s ^0 ^0.04 ^-0.04
execute if score @s AsaMatrix matches 6 run function asa_animator:reia/anim/flying_charge/keyframes/1
execute if score @s AsaMatrix matches 6..15 run tp @s ^0 ^0.02 ^-0.02
execute if score @s AsaMatrix matches 16 run function asa_animator:reia/anim/flying_charge/keyframes/2
execute if score @s AsaMatrix matches 16..36 run tp @s ^0 ^0.01428571 ^-0.02857143
execute if score @s AsaMatrix matches 37 run function asa_animator:reia/anim/flying_charge/keyframes/3
execute if score @s AsaMatrix matches 37..45 run tp @s ^0 ^0.5888889 ^0
execute if score @s AsaMatrix matches 46 run function asa_animator:reia/anim/flying_charge/keyframes/4
execute if score @s AsaMatrix matches 46..52 run tp @s ^0 ^-0.5714286 ^0
execute if score @s AsaMatrix matches 53 run function asa_animator:reia/anim/flying_charge/keyframes/5
execute if score @s AsaMatrix matches 53..60 run tp @s ^0 ^-0.1625 ^0
execute if score @s AsaMatrix matches 61 run function asa_animator:reia/anim/flying_charge/keyframes/6
execute if score @s AsaMatrix matches 61..72 run tp @s ^0 ^0 ^-0.1
execute if score @s AsaMatrix matches 73 run function asa_animator:reia/anim/flying_charge/keyframes/7
execute if score @s AsaMatrix matches 73..82 run tp @s ^0 ^0 ^0
execute if score @s AsaMatrix matches 83.. run function asa_animator:reia/anim/flying_charge/end
execute as @e[type=armor_stand,tag=ReiaParts] run function #asa_matrix:animate
function asa_animator:reia/model

execute if score @s AsaMatrix matches 14 run playsound entity.ender_dragon.flap master @a ~ ~ ~ 2 0.7
execute if score @s AsaMatrix matches 43 run playsound entity.ender_dragon.flap master @a ~ ~ ~ 2 0.7
execute if score @s AsaMatrix matches 58 run playsound entity.ender_dragon.flap master @a ~ ~ ~ 2 0.7

# 敵を向く
execute if score @s AsaMatrix matches ..19 run function asa_animator:reia/manager/rotate

# 発射位置決定
execute if score @s AsaMatrix matches 20 run summon marker ^ ^0.7 ^8 {Tags:["ReiaBreathTarget"]}
execute if score @s AsaMatrix matches 20 unless entity @e[distance=0..8,tag=ReiaAttackTarget] at @e[tag=ReiaAttackTarget,limit=1] run tp @e[type=marker,tag=ReiaBreathTarget] ~ ~ ~
execute if score @s AsaMatrix matches 1 run playsound entity.player.breath master @a ~ ~ ~ 2 0.9
execute if score @s AsaMatrix matches 1..39 as @e[distance=0..15,type=armor_stand,tag=ReiaParts,tag=HeadU] at @s positioned ^ ^1.2 ^0.2 run particle flame ~ ~ ~ 0 0 0 0.03 5

# ブレス発射
execute if score @s AsaMatrix matches 43 positioned ^ ^3 ^5 facing entity @e[type=marker,tag=ReiaBreathTarget,limit=1] feet run function asa_animator:reia/anim/charge/events/shot
execute if score @s AsaMatrix matches 43 as @e[type=marker,tag=ReiaCharge] at @s positioned ^ ^ ^4 run function asa_animator:reia/anim/charge/events/damage
execute if score @s AsaMatrix matches 47 as @e[type=marker,tag=ReiaCharge] at @s positioned ^-4 ^ ^2 run function asa_animator:reia/anim/charge/events/damage
execute if score @s AsaMatrix matches 51 as @e[type=marker,tag=ReiaCharge] at @s positioned ^2.5 ^ ^-4 run function asa_animator:reia/anim/charge/events/damage
execute if score @s AsaMatrix matches 55 as @e[type=marker,tag=ReiaCharge] at @s positioned ^4 ^ ^3 run function asa_animator:reia/anim/charge/events/damage
execute if score @s AsaMatrix matches 59 as @e[type=marker,tag=ReiaCharge] at @s positioned ^-2 ^ ^-2 run function asa_animator:reia/anim/charge/events/damage
execute if score @s AsaMatrix matches 59 run kill @e[type=marker,tag=ReiaCharge]

# 着地
execute if score @s AsaMatrix matches 35 run function asa_animator:reia/anim/bjb_land/events/set_pos
execute if score @s AsaMatrix matches 36..60 run function asa_animator:reia/anim/bjb_land/events/offset
execute if score @s AsaMatrix matches 60 run playsound block.grass.step master @a ~ ~ ~ 2 0.7
execute if score @s AsaMatrix matches 60 run particle block grass_block ~ ~ ~ 1 0.1 1 0 10